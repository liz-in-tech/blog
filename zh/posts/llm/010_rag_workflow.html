<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.0" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.13" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="alternate" hreflang="en-us" href="https://liz-in-tech.github.io/blog/posts/llm/010_rag_workflow.html"><meta property="og:url" content="https://liz-in-tech.github.io/blog/zh/posts/llm/010_rag_workflow.html"><meta property="og:site_name" content="Liz"><meta property="og:title" content="RAG工作流与RAG优化"><meta property="og:description" content="RAG工作流与RAG优化 原生数据处理流 问答场景中RAG的流程 RAG优化点 RAG优化: Query优化 / Retriever优化 / Ranking优化 / Indexing优化"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:locale:alternate" content="en-US"><meta property="og:updated_time" content="2025-04-10T09:24:41.000Z"><meta property="article:author" content="Liz"><meta property="article:tag" content="RAG"><meta property="article:tag" content="Workflow"><meta property="article:published_time" content="2024-10-31T00:00:00.000Z"><meta property="article:modified_time" content="2025-04-10T09:24:41.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"RAG工作流与RAG优化","image":[""],"datePublished":"2024-10-31T00:00:00.000Z","dateModified":"2025-04-10T09:24:41.000Z","author":[{"@type":"Person","name":"Liz","url":"https://github.com/liz-in-tech"}]}</script><link rel="icon" herf="/blogger.png"><link rel="icon" href="/blog/blogger.png"><title>RAG工作流与RAG优化 | Liz</title><meta name="description" content="RAG工作流与RAG优化 原生数据处理流 问答场景中RAG的流程 RAG优化点 RAG优化: Query优化 / Retriever优化 / Ranking优化 / Indexing优化">
    <link rel="preload" href="/blog/assets/style-m_obra2h.css" as="style"><link rel="stylesheet" href="/blog/assets/style-m_obra2h.css">
    <link rel="modulepreload" href="/blog/assets/app-kXW_Y_m4.js"><link rel="modulepreload" href="/blog/assets/010_rag_workflow.html-t5n89ijV.js"><link rel="modulepreload" href="/blog/assets/010_hierarchical_index_retrieval-bg_di8nz.js"><link rel="modulepreload" href="/blog/assets/plugin-vue_export-helper-x3n3nnut.js"><link rel="modulepreload" href="/blog/assets/010_rag_workflow.html-bgEctrLI.js">
    <link rel="prefetch" href="/blog/assets/index.html-YbPtte5_.js" as="script"><link rel="prefetch" href="/blog/assets/intro.html-CGfhr1vY.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-FUMOuem4.js" as="script"><link rel="prefetch" href="/blog/assets/index.html--TTjrkIy.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-g4Nfr7z1.js" as="script"><link rel="prefetch" href="/blog/assets/intro.html-bitGHKd2.js" as="script"><link rel="prefetch" href="/blog/assets/001_langchain.html-pCFuhYHy.js" as="script"><link rel="prefetch" href="/blog/assets/002_langchain_sourcecode.html-0dULq4fV.js" as="script"><link rel="prefetch" href="/blog/assets/003_streamlit.html-rU-ICBCx.js" as="script"><link rel="prefetch" href="/blog/assets/004_transformer.html-rVimVVvM.js" as="script"><link rel="prefetch" href="/blog/assets/005_llama.html-PPnfWd5A.js" as="script"><link rel="prefetch" href="/blog/assets/006_llm_leaderboard.html-IMCQYiuX.js" as="script"><link rel="prefetch" href="/blog/assets/007_computer_use.html-NXAgxCZc.js" as="script"><link rel="prefetch" href="/blog/assets/008_rag_challenge.html-2XihIpNV.js" as="script"><link rel="prefetch" href="/blog/assets/009_llm_challenge.html-c_OZVW4n.js" as="script"><link rel="prefetch" href="/blog/assets/010_rag_workflow.html-VAQDBYt1.js" as="script"><link rel="prefetch" href="/blog/assets/011_vector_database.html-lYSX4LTx.js" as="script"><link rel="prefetch" href="/blog/assets/012_prompt_engineering.html-UWcw4rK7.js" as="script"><link rel="prefetch" href="/blog/assets/013_optimizing_llm.html-6CxOIR84.js" as="script"><link rel="prefetch" href="/blog/assets/014_rag_evaluation.html-GIu-oGwK.js" as="script"><link rel="prefetch" href="/blog/assets/015_fine_tune.html-dGpakwon.js" as="script"><link rel="prefetch" href="/blog/assets/016_multimodal.html-rrs6OqYq.js" as="script"><link rel="prefetch" href="/blog/assets/017_agent_and_multiagent.html-tCPGJV8e.js" as="script"><link rel="prefetch" href="/blog/assets/018_huggingface.html-xa6dHS9r.js" as="script"><link rel="prefetch" href="/blog/assets/019_ollama.html-plb_Orn6.js" as="script"><link rel="prefetch" href="/blog/assets/020_neo4j.html-a2aBhY6q.js" as="script"><link rel="prefetch" href="/blog/assets/021_microsoft_graphrag.html-oPHcVCmi.js" as="script"><link rel="prefetch" href="/blog/assets/022_llamaindex_graphrag.html-h0RgV0s1.js" as="script"><link rel="prefetch" href="/blog/assets/023_agent_framework.html-py7Qkdf7.js" as="script"><link rel="prefetch" href="/blog/assets/024_distribution_and_parallelism.html-CKC7PrZL.js" as="script"><link rel="prefetch" href="/blog/assets/025_distribution_and_parallelism_1.html-beQNseCy.js" as="script"><link rel="prefetch" href="/blog/assets/026_distribution_and_parallelism_2.html-6kfObp4n.js" as="script"><link rel="prefetch" href="/blog/assets/027_distribution_and_parallelism_3.html-jqwUVAB8.js" as="script"><link rel="prefetch" href="/blog/assets/028_distribution_and_parallelism_4.html-P64lj0UC.js" as="script"><link rel="prefetch" href="/blog/assets/029_unsloth_grpo.html-1JeKlSnS.js" as="script"><link rel="prefetch" href="/blog/assets/030_wandb.html-WMD5mJL9.js" as="script"><link rel="prefetch" href="/blog/assets/031_qlora.html-JOYVOncP.js" as="script"><link rel="prefetch" href="/blog/assets/032_sft_trainer_sourcecode_prepare_model.html-zHdm8hdr.js" as="script"><link rel="prefetch" href="/blog/assets/033_sft_trainer_sourcecode_prepare_dataset.html-q1ngNI0S.js" as="script"><link rel="prefetch" href="/blog/assets/034_sft_trainer_sourcecode_prepare_trainer.html-R_OJ2ypq.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ZDCSnlc1.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ZYw6WxxA.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-OavE9BET.js" as="script"><link rel="prefetch" href="/blog/assets/001_langchain.html-tEkJTRMy.js" as="script"><link rel="prefetch" href="/blog/assets/002_langchain_sourcecode.html-Cf9F-5tQ.js" as="script"><link rel="prefetch" href="/blog/assets/003_streamlit.html-HjDyRBtK.js" as="script"><link rel="prefetch" href="/blog/assets/004_transformer.html-LcEZruqw.js" as="script"><link rel="prefetch" href="/blog/assets/005_llama.html-RH03PuTh.js" as="script"><link rel="prefetch" href="/blog/assets/006_llm_leaderboard.html-oHc2EEDF.js" as="script"><link rel="prefetch" href="/blog/assets/007_computer_use.html-9uep80On.js" as="script"><link rel="prefetch" href="/blog/assets/008_rag_challenge.html-n6JQ6oC1.js" as="script"><link rel="prefetch" href="/blog/assets/009_llm_challenge.html-xfwZXlYi.js" as="script"><link rel="prefetch" href="/blog/assets/011_vector_database.html-1VYu1fJ-.js" as="script"><link rel="prefetch" href="/blog/assets/012_prompt_engineering.html-tWg28gSw.js" as="script"><link rel="prefetch" href="/blog/assets/013_optimizing_llm.html-W-CdR_ck.js" as="script"><link rel="prefetch" href="/blog/assets/014_rag_evaluation.html-QoGrIyLb.js" as="script"><link rel="prefetch" href="/blog/assets/015_fine_tune.html-B8-mxmmH.js" as="script"><link rel="prefetch" href="/blog/assets/016_multimodal.html-wKLzc0PX.js" as="script"><link rel="prefetch" href="/blog/assets/017_agent_and_multiagent.html-oSXpre05.js" as="script"><link rel="prefetch" href="/blog/assets/018_huggingface.html-z4dUNzIp.js" as="script"><link rel="prefetch" href="/blog/assets/019_ollama.html-BEfb0F5v.js" as="script"><link rel="prefetch" href="/blog/assets/020_neo4j.html-Ss2gFNbK.js" as="script"><link rel="prefetch" href="/blog/assets/021_microsoft_graphrag.html-i7xll12O.js" as="script"><link rel="prefetch" href="/blog/assets/022_llamaindex_graphrag.html-SaWe1p9V.js" as="script"><link rel="prefetch" href="/blog/assets/023_agent_framework.html-SPruHtsV.js" as="script"><link rel="prefetch" href="/blog/assets/024_distribution_and_parallelism.html-7h-MA_ID.js" as="script"><link rel="prefetch" href="/blog/assets/025_distribution_and_parallelism_1.html-L8sqluO4.js" as="script"><link rel="prefetch" href="/blog/assets/026_distribution_and_parallelism_2.html-unSOw2um.js" as="script"><link rel="prefetch" href="/blog/assets/027_distribution_and_parallelism_3.html-lLxN0up_.js" as="script"><link rel="prefetch" href="/blog/assets/028_distribution_and_parallelism_4.html-J-NQUUQ-.js" as="script"><link rel="prefetch" href="/blog/assets/029_unsloth_grpo.html-BWNBotHO.js" as="script"><link rel="prefetch" href="/blog/assets/030_wandb.html-K-PdjuDZ.js" as="script"><link rel="prefetch" href="/blog/assets/031_qlora.html-vUUfqpgA.js" as="script"><link rel="prefetch" href="/blog/assets/032_sft_trainer_sourcecode_prepare_model.html-1k2dTbN6.js" as="script"><link rel="prefetch" href="/blog/assets/033_sft_trainer_sourcecode_prepare_dataset.html-yXer_-iN.js" as="script"><link rel="prefetch" href="/blog/assets/034_sft_trainer_sourcecode_prepare_trainer.html-dD57N9_q.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-wh_dBtOR.js" as="script"><link rel="prefetch" href="/blog/assets/404.html-cxLWDy2T.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-kf4JCRaf.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-RkA-insV.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-4kI_oqSd.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-WhuidxNt.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-OqGkeUA_.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-5GeN-sdD.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-c4Rf4yh1.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-2r0jUs7o.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BSKRXRQc.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-KjTsJ0Hg.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-TteIwMx3.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-g00XXzrL.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-YxbJgo4L.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3T79Cy0i.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-A5tlQHan.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-04ff5e0O.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-vgZ6rfFh.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-OmipPplE.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-E1KrJL6a.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-oPH9QkTj.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-cHRqZSs8.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-74SU9ZTn.js" as="script"><link rel="prefetch" href="/blog/assets/index.html--iJiA8oX.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-oZPWb_Fc.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-FUIWSLsp.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-5ERWyusD.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Zjn0JNqd.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-jcvPTrgB.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-9t2TsyuQ.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CcLVFNIv.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DVoYOOaL.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-V52ipvRm.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-9If_KW0o.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-df9Mrf2R.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-f9bWoKcO.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-GYH0QUoo.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-JVTfeijx.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-_C1QVNqX.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-L_IXFmna.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-nZWHmXY7.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-x4gPgqE4.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-bWnVyuyA.js" as="script"><link rel="prefetch" href="/blog/assets/index.html--yTU23ka.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-tRnpyzfw.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-7aypos-L.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-1BXcbV1R.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-pu478WKz.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DFi1VhMA.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-7uaSljkV.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BULhD4SJ.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-i7RIA9-O.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-NNpPPGUU.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-LHukpLS7.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-howjHe2f.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DeN_iOWx.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-cnlzR0a7.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-0P_c_pcU.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-dy_CcFmq.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-FzFytZ_p.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-2KSwV7xp.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-F1coElwg.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ffflqCb9.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-F8ZuLYgH.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-HeYWaFeL.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-xKYeJEc5.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-xB-iS7Ql.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-OEUPqfTV.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-EE4iQI9m.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-g1PUF_BG.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-nUBcs85a.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-9Y3la5Sf.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-wufIFDPM.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-bXZQIxRE.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-wd6ZkEHi.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Xlk0AXmC.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Uv7c7pYa.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-FfZqC9tZ.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-mSPhZxqB.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-51HoKD5A.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Q5_K6Vux.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-jkWPo860.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-kTEqch5G.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-y4iBqBqc.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ibHhI9SI.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3hk_s27_.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-QJ9j3Zl2.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-QvWFHL99.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Pefl6i_g.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-dNHrcQzx.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-tITHrBRq.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-r_IMIQdZ.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-FFF0RGO4.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-9IXcskQt.js" as="script"><link rel="prefetch" href="/blog/assets/index.html--vv6JGdg.js" as="script"><link rel="prefetch" href="/blog/assets/intro.html-YvsAdYxx.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-eb3rY0JS.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-mySahdpU.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-b9L3Yulv.js" as="script"><link rel="prefetch" href="/blog/assets/intro.html-1rtPqIag.js" as="script"><link rel="prefetch" href="/blog/assets/001_langchain.html-u0RDenox.js" as="script"><link rel="prefetch" href="/blog/assets/002_langchain_sourcecode.html-WatFl6W7.js" as="script"><link rel="prefetch" href="/blog/assets/003_streamlit.html-jtSVjIgP.js" as="script"><link rel="prefetch" href="/blog/assets/004_transformer.html-9gOECARp.js" as="script"><link rel="prefetch" href="/blog/assets/005_llama.html-y7jJcJ9i.js" as="script"><link rel="prefetch" href="/blog/assets/006_llm_leaderboard.html-Nm0wyQhM.js" as="script"><link rel="prefetch" href="/blog/assets/007_computer_use.html-t0wOZl_C.js" as="script"><link rel="prefetch" href="/blog/assets/008_rag_challenge.html-XVsVvL4j.js" as="script"><link rel="prefetch" href="/blog/assets/009_llm_challenge.html-NxAiW0a6.js" as="script"><link rel="prefetch" href="/blog/assets/010_rag_workflow.html-R9FUmgH-.js" as="script"><link rel="prefetch" href="/blog/assets/011_vector_database.html-wQT5qFnh.js" as="script"><link rel="prefetch" href="/blog/assets/012_prompt_engineering.html-6JEjQ-kc.js" as="script"><link rel="prefetch" href="/blog/assets/013_optimizing_llm.html-Hj-oim2-.js" as="script"><link rel="prefetch" href="/blog/assets/014_rag_evaluation.html-342TIWnM.js" as="script"><link rel="prefetch" href="/blog/assets/015_fine_tune.html-nSVN6FoD.js" as="script"><link rel="prefetch" href="/blog/assets/016_multimodal.html-n1S4D29K.js" as="script"><link rel="prefetch" href="/blog/assets/017_agent_and_multiagent.html-qO9GAGXk.js" as="script"><link rel="prefetch" href="/blog/assets/018_huggingface.html-O5p-7ZP4.js" as="script"><link rel="prefetch" href="/blog/assets/019_ollama.html-wjeXoczl.js" as="script"><link rel="prefetch" href="/blog/assets/020_neo4j.html-ANtI9KHv.js" as="script"><link rel="prefetch" href="/blog/assets/021_microsoft_graphrag.html-cztMBRXf.js" as="script"><link rel="prefetch" href="/blog/assets/022_llamaindex_graphrag.html-hxfazdpU.js" as="script"><link rel="prefetch" href="/blog/assets/023_agent_framework.html-TNE_e7Ko.js" as="script"><link rel="prefetch" href="/blog/assets/024_distribution_and_parallelism.html-2250dNkH.js" as="script"><link rel="prefetch" href="/blog/assets/025_distribution_and_parallelism_1.html-XZUCp34v.js" as="script"><link rel="prefetch" href="/blog/assets/026_distribution_and_parallelism_2.html-chQN8UEq.js" as="script"><link rel="prefetch" href="/blog/assets/027_distribution_and_parallelism_3.html-0Uoi9GcL.js" as="script"><link rel="prefetch" href="/blog/assets/028_distribution_and_parallelism_4.html-gfN4lwG1.js" as="script"><link rel="prefetch" href="/blog/assets/029_unsloth_grpo.html-yTNsmKtu.js" as="script"><link rel="prefetch" href="/blog/assets/030_wandb.html-5ubs6DMV.js" as="script"><link rel="prefetch" href="/blog/assets/031_qlora.html-SoizIESE.js" as="script"><link rel="prefetch" href="/blog/assets/032_sft_trainer_sourcecode_prepare_model.html-APTXTm8o.js" as="script"><link rel="prefetch" href="/blog/assets/033_sft_trainer_sourcecode_prepare_dataset.html-RoUISmX5.js" as="script"><link rel="prefetch" href="/blog/assets/034_sft_trainer_sourcecode_prepare_trainer.html-n3BuAGze.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-m0ANQlb1.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-6NYkVY7P.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-VWh-VMRn.js" as="script"><link rel="prefetch" href="/blog/assets/001_langchain.html-jR7MnvbH.js" as="script"><link rel="prefetch" href="/blog/assets/002_langchain_sourcecode.html-QnvaYX8S.js" as="script"><link rel="prefetch" href="/blog/assets/003_streamlit.html-yvvRwshv.js" as="script"><link rel="prefetch" href="/blog/assets/004_transformer.html-lD-gg3r4.js" as="script"><link rel="prefetch" href="/blog/assets/005_llama.html-cJJfpF1E.js" as="script"><link rel="prefetch" href="/blog/assets/006_llm_leaderboard.html-ZNgRpXeA.js" as="script"><link rel="prefetch" href="/blog/assets/007_computer_use.html-olgphtpX.js" as="script"><link rel="prefetch" href="/blog/assets/008_rag_challenge.html-qnP9y6an.js" as="script"><link rel="prefetch" href="/blog/assets/009_llm_challenge.html-CN4Qdfzf.js" as="script"><link rel="prefetch" href="/blog/assets/011_vector_database.html-Ext8qBK4.js" as="script"><link rel="prefetch" href="/blog/assets/012_prompt_engineering.html-DgFmhAmz.js" as="script"><link rel="prefetch" href="/blog/assets/013_optimizing_llm.html-V8RwrYtw.js" as="script"><link rel="prefetch" href="/blog/assets/014_rag_evaluation.html-8gnsrekE.js" as="script"><link rel="prefetch" href="/blog/assets/015_fine_tune.html-P6p3N9FU.js" as="script"><link rel="prefetch" href="/blog/assets/016_multimodal.html-JunLNeNq.js" as="script"><link rel="prefetch" href="/blog/assets/017_agent_and_multiagent.html-HxOtf7NJ.js" as="script"><link rel="prefetch" href="/blog/assets/018_huggingface.html-jZau-Rer.js" as="script"><link rel="prefetch" href="/blog/assets/019_ollama.html-snxKNrOO.js" as="script"><link rel="prefetch" href="/blog/assets/020_neo4j.html-d843Oc_u.js" as="script"><link rel="prefetch" href="/blog/assets/021_microsoft_graphrag.html-OB6BrwMG.js" as="script"><link rel="prefetch" href="/blog/assets/022_llamaindex_graphrag.html-piyaZZMv.js" as="script"><link rel="prefetch" href="/blog/assets/023_agent_framework.html-Db4bujEY.js" as="script"><link rel="prefetch" href="/blog/assets/024_distribution_and_parallelism.html-gz26Lwy_.js" as="script"><link rel="prefetch" href="/blog/assets/025_distribution_and_parallelism_1.html-U1AbCk1f.js" as="script"><link rel="prefetch" href="/blog/assets/026_distribution_and_parallelism_2.html-Lcr0R0BX.js" as="script"><link rel="prefetch" href="/blog/assets/027_distribution_and_parallelism_3.html-V0xT7zv-.js" as="script"><link rel="prefetch" href="/blog/assets/028_distribution_and_parallelism_4.html-tlVKPUH9.js" as="script"><link rel="prefetch" href="/blog/assets/029_unsloth_grpo.html--YdolqUA.js" as="script"><link rel="prefetch" href="/blog/assets/030_wandb.html-ydOOp5Wd.js" as="script"><link rel="prefetch" href="/blog/assets/031_qlora.html-fQEUG9mQ.js" as="script"><link rel="prefetch" href="/blog/assets/032_sft_trainer_sourcecode_prepare_model.html-Twac33Fz.js" as="script"><link rel="prefetch" href="/blog/assets/033_sft_trainer_sourcecode_prepare_dataset.html-NlOuqPei.js" as="script"><link rel="prefetch" href="/blog/assets/034_sft_trainer_sourcecode_prepare_trainer.html-sWIk8upS.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-f256oXCe.js" as="script"><link rel="prefetch" href="/blog/assets/404.html-_ynXrPVJ.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-KpiV2RZz.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Gl6JFTdW.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-S86WhvAg.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-0g2T9BBe.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-8VfnHEti.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-V13AKav4.js" as="script"><link rel="prefetch" href="/blog/assets/index.html--0znw6Jg.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-rUDgnkod.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Ixtz_6gm.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-8tqIo_Lg.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-MZjAI5Ua.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-yy_XHxVn.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-xxChQGkq.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-0X96kPbJ.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-TVlZkaii.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ib-1P8D-.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Yfp0ZYQ2.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-wV_rTQOo.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BmwFcS5I.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-WPhR4yZO.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-1AuLEwQS.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-t5JEzQSr.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Iu8R6uJH.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Wn8ixjAY.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Ki18f85e.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-WjefiZt5.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-63xcNFpn.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-qs0qFF3o.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-j0fApRBn.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-7nh-_nZc.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-4iOdijQ-.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-TTnq10vf.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ITvv5s67.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-MLj0stui.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-lflu9wkH.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-uXsg2Qms.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Vk5N7WSy.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-nSZN_e3l.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-2mvev2Dv.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-_sQvIyGu.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-7fq0Vgi2.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-yy6Hfbps.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-1euV8Kyn.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-QFnJJUPx.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-bKw0s3tH.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-YglVXsq6.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-LTj1tjv7.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-tjrWLtoj.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ij3lqDMP.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-_olKXUI2.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-6HWH81DY.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-jqbSHvu_.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DSVuec5V.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-etKhx9jx.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-LblJcp8D.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-sKp0rMKu.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-oFfN1H8M.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Wj1Ml6_D.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-hy7JS5_M.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-46xlHXXB.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-eJwc_Sty.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-jhvadMVJ.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-V0i6juId.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-dsZvhGqF.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-t6Rda_m2.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-bJEZ4q4k.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-i2VN5SxX.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-XzyKaecF.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-TtNUL7su.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Feg0AZzF.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-87rl9up6.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-paP6q3A6.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-C0NU7zNv.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-AyZe6Vnz.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ZKBCLERe.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-QWjjGYjF.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-TjxS4F0D.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-c8l9SA_F.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Miisefi3.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Hcx1AKtm.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Yx9Gv2HW.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Gs7gohuD.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-pfgkam3J.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-nokndBo_.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-e82V4ede.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-iAbJDWKb.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-vCEw4W4i.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-xM1AdLMf.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-yw3VVVGg.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-XOoPS9Dm.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-lx1h2lJu.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-VFSaxyAl.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-VFnMz1F0.js" as="script"><link rel="prefetch" href="/blog/assets/photoswipe.esm-08_zHRDQ.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><!--[--><div class="theme-container no-sidebar has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="vp-link vp-brand vp-brand" href="/blog/zh/"><img class="vp-nav-logo" src="/blog/blogger.png" alt><!----><span class="vp-site-name hide-in-pad">Liz</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a aria-label="首页" class="vp-link nav-link nav-link" href="/blog/zh/"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>首页<!----></a></div><div class="nav-item hide-in-mobile"><a aria-label="项目" class="vp-link nav-link nav-link" href="/blog/zh/demo/"><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span>项目<!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><div class="nav-item"><div class="dropdown-wrapper i18n-dropdown"><button type="button" class="dropdown-title" aria-label="选择语言"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon i18n-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="i18n icon" style="width:1rem;height:1rem;vertical-align:middle;"><path d="M379.392 460.8 494.08 575.488l-42.496 102.4L307.2 532.48 138.24 701.44l-71.68-72.704L234.496 460.8l-45.056-45.056c-27.136-27.136-51.2-66.56-66.56-108.544h112.64c7.68 14.336 16.896 27.136 26.112 35.84l45.568 46.08 45.056-45.056C382.976 312.32 409.6 247.808 409.6 204.8H0V102.4h256V0h102.4v102.4h256v102.4H512c0 70.144-37.888 161.28-87.04 210.944L378.88 460.8zM576 870.4 512 1024H409.6l256-614.4H768l256 614.4H921.6l-64-153.6H576zM618.496 768h196.608L716.8 532.48 618.496 768z"></path></svg><!--]--><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a aria-label="English" class="vp-link nav-link nav-link" href="/blog/posts/llm/010_rag_workflow.html"><!---->English<!----></a></li><li class="dropdown-item"><a aria-label="简体中文" class="vp-link nav-link active nav-link active" href="/blog/zh/posts/llm/010_rag_workflow.html"><!---->简体中文<!----></a></li></ul></button></div></div><div class="nav-item vp-repo"><a class="vp-repo-link" href="https://github.com/liz-in-tech" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><form class="search-box" role="search"><input type="search" placeholder="搜索" autocomplete="off" spellcheck="false" value><!----></form><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!--[--><!----><!--]--><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><span class="font-icon icon fa-fw fa-sm fas fa-lightbulb" style=""></span>RAG工作流与RAG优化</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/liz-in-tech" target="_blank" rel="noopener noreferrer">Liz</a></span><span property="author" content="Liz"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-10-31T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 11 分钟</span><meta property="timeRequired" content="PT11M"></span><span class="page-category-info" aria-label="分类🌈" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item category6 clickable" role="navigation">LLM</span><!--]--><meta property="articleSection" content="LLM"></span><span class="page-tag-info" aria-label="标签🏷" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item tag5 clickable" role="navigation">RAG</span><span class="page-tag-item tag3 clickable" role="navigation">Workflow</span><!--]--><meta property="keywords" content="RAG,Workflow"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_1-原生数据处理流">1. 原生数据处理流</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_2-问答场景中rag的流程">2. 问答场景中RAG的流程</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_3-rag优化点">3. RAG优化点</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_3-1-原生数据处理流优化点">3.1. 原生数据处理流优化点</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_3-2-问答场景中rag的流程优化点">3.2. 问答场景中RAG的流程优化点</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_4-rag场景中的prompt">4. RAG场景中的Prompt</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_5-文本分割方式">5. 文本分割方式</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_6-rag优化-——-query优化">6. RAG优化 —— Query优化</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_6-1-case1-self-querying-retrieval">6.1. Case1：Self-Querying Retrieval</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_6-2-case2-multiqueryretriever">6.2. Case2: MultiQueryRetriever</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_6-3-case3-回退式提示词-step-back-prompting">6.3. Case3: 回退式提示词 Step-Back Prompting</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_6-4-case4-query和history的结合方式">6.4. Case4: Query和History的结合方式</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_6-5-case5-假设性答案-hypothetical-answer-hypothetical-document">6.5. Case5: 假设性答案  Hypothetical Answer / Hypothetical Document</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_6-6-case6-查询重写">6.6. Case6: 查询重写</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_6-7-case7-查询路由">6.7. Case7: 查询路由</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_7-rag优化-——-retriever优化">7. RAG优化 —— Retriever优化</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_7-1-case1-句子窗口检索-sentence-window-retrieval">7.1. Case1：句子窗口检索 Sentence Window Retrieval</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_7-2-case2-父文档检索器-parent-child-chunks-retrieval-from-small-to-big">7.2. Case2: 父文档检索器 Parent-child chunks retrieval /from small to big</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_7-3-case3-混合检索-fusion-retrieval">7.3. Case3: 混合检索 Fusion Retrieval</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_8-rag优化-——-ranking优化">8. RAG优化 —— Ranking优化</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_8-1-逆序位融合算法-rrf-reciprocal-rank-fusion">8.1. 逆序位融合算法 RRF (Reciprocal Rank Fusion)</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_9-rag优化-——-indexing优化">9. RAG优化 —— Indexing优化</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_9-1-层次索引">9.1. 层次索引</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_9-2-假设性问题">9.2. 假设性问题</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_10-rag优化-——-其他优化">10. RAG优化 —— 其他优化</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#reference-citations-参考引用">Reference citations  参考引用</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_11-graphrag">11. GraphRAG</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_12-hybirdrag">12. HybirdRAG</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_13-references">13. References</a></li><!----><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!--[--><!----><!--]--><div class="theme-hope-content"><h1 id="rag工作流与rag优化" tabindex="-1"><a class="header-anchor" href="#rag工作流与rag优化" aria-hidden="true">#</a> RAG工作流与RAG优化</h1><ul><li>原生数据处理流</li><li>问答场景中RAG的流程</li><li>RAG优化点</li><li>RAG优化: Query优化 / Retriever优化 / Ranking优化 / Indexing优化</li></ul><!-- more --><h2 id="_1-原生数据处理流" tabindex="-1"><a class="header-anchor" href="#_1-原生数据处理流" aria-hidden="true">#</a> 1. 原生数据处理流</h2><figure><img src="/blog/assets/010_rag_data_process-Nh9oZM-T.png" alt="原生数据处理流" tabindex="0" loading="lazy"><figcaption>原生数据处理流</figcaption></figure><ul><li>1.原生数据 Raw Data</li><li>2.数据加载 Data Loader</li><li>3.数据转换（数据解析/数据清洗）Data Transformer(Data Parsing/Data Cleaning)</li><li>4.数据分割 Data Split <ul><li>分割为多个块 Chunk</li><li>分割大小的权衡</li></ul></li><li>5.数据向量化 <ul><li>将 Chunk 表示为 Vector</li><li>Text Embedding Model</li></ul></li><li>6.数据存储 Vector Store <ul><li>存储到向量数据库，建立索引 indexing</li></ul></li><li>7.数据检索 Retriever</li></ul><h2 id="_2-问答场景中rag的流程" tabindex="-1"><a class="header-anchor" href="#_2-问答场景中rag的流程" aria-hidden="true">#</a> 2. 问答场景中RAG的流程</h2><figure><img src="/blog/assets/010_rag_qa_process-keKzFPsZ.jpg" alt="问答场景中RAG的流程" tabindex="0" loading="lazy"><figcaption>问答场景中RAG的流程</figcaption></figure><ul><li>1.用户发起问题 Query</li><li>2.将用户问题 Query 使用嵌入模型 Embedding Model 向量化</li><li>3.得到向量化过的用户问题 Query Vector</li><li>4.用向量化过的用户问题 Query Vector 检索向量数据库 Vector Database <ul><li>将向量数据库用作外部知识库</li></ul></li><li>5.通过语义相似性检索出 Top k 的向量</li><li>6.将 Top K 的向量对应语义内容和用户问题 Query 作为 Prompt 调用 LLM</li><li>7.LLM 根据用户问题和检索到的数据信息给出问题的答案</li><li>8.用户得到答案</li></ul><figure><img src="/blog/assets/010_rag_overall-Hfqfx9Sn.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>RAG的构建与问答步骤总体概括为三点</p><ul><li>Indexing</li><li>Retrieval</li><li>Generation</li></ul><h2 id="_3-rag优化点" tabindex="-1"><a class="header-anchor" href="#_3-rag优化点" aria-hidden="true">#</a> 3. RAG优化点</h2><h3 id="_3-1-原生数据处理流优化点" tabindex="-1"><a class="header-anchor" href="#_3-1-原生数据处理流优化点" aria-hidden="true">#</a> 3.1. 原生数据处理流优化点</h3><ul><li>For step1: 原生数据 <ul><li>知识图谱 <ul><li>越来越多的工作把知识图谱 (Knowledge Graph) Introduce到RAG中，如: <ul><li>KnowledGPT 用于推理阶段</li><li>SUGRE 用于微调阶段</li></ul></li></ul></li></ul></li><li>For step3：解析文档 <ul><li>难点：不同文档类型(eg.pdf，html，ppt)的解析方式不同，文档不规则，且包含表格、公式、图片等形式难以解析；多模态数据：文本、图片、音频、视频；</li><li>表格 <ul><li>挑战： <ul><li>文本分割过程可能会分离表格，导致数据损坏</li><li>将表格作为检索数据，会使语义相似性搜索过程复杂化</li></ul></li><li>解决： <ul><li>利用代码执行Text-2-SQL查询</li><li>将表格转为描述性文字</li></ul></li></ul></li><li>考虑解析的准确性</li></ul></li><li>For step4：文本分割 <ul><li>难点：不同分割方式对后续任务有影响</li><li>考虑chunk方式和参数的选择，以及尝试不同算法的成本</li><li>块的大小：分割粒度太大，每个Chunk包含更多信息，可以一并返回更多Context; 分割粒度太小，可以更准确的检索更相关的Chunks</li><li>关于选择块大小的研究，可以在LlamaIndex的NodeParser类中找到，该类提供了一些高级选项，比如定义自己的文本分割器、元数据、节点/块关系等。</li></ul></li><li>For step6: 向量索引 <ul><li>不同向量数据库的选择</li><li>不同索引的选择</li><li>索引的优化 <ul><li>添加元数据 Add metadata (time, type, title, subtitle, part of doc)</li></ul></li></ul></li></ul><h3 id="_3-2-问答场景中rag的流程优化点" tabindex="-1"><a class="header-anchor" href="#_3-2-问答场景中rag的流程优化点" aria-hidden="true">#</a> 3.2. 问答场景中RAG的流程优化点</h3><ul><li>For step2：Query向量化 <ul><li>Query在向量化时，是否需要进行处理（Query的清洗） -&gt; Refined Query</li><li>用户问的问题可能不完整，不准确，很复杂，不是连贯的一句话</li></ul></li><li>For step5：检索top k <ul><li>是否足够回复问题，是否很多是多余的</li><li>将Recall和Ranking分开处理</li><li>Recall (召回，eg.从向量数据库召回50条相关数据) =&gt; Ranking (排序，eg.将召回的50条排序，取top3)</li><li>是否需要排序，怎么排序</li></ul></li><li>For step7:得到LLM响应结果 <ul><li>后处理 post processing</li><li>In LlamaIndex there is a variety of available Postprocessors, filtering out results based on similarity score, keywords, metadata or reranking them with other models like an LLM, sentence-transformer cross-encoder, Cohere reranking endpoint or based on metadata like date recency — basically, all you could imagine.</li></ul></li></ul><h2 id="_4-rag场景中的prompt" tabindex="-1"><a class="header-anchor" href="#_4-rag场景中的prompt" aria-hidden="true">#</a> 4. RAG场景中的Prompt</h2><ul><li>Instruction</li><li>Context =&gt; Retrieval</li><li>Input =&gt; Query</li><li>History</li></ul><h2 id="_5-文本分割方式" tabindex="-1"><a class="header-anchor" href="#_5-文本分割方式" aria-hidden="true">#</a> 5. 文本分割方式</h2><ul><li>目的 <ul><li>能够检索到和Query更相关的内容</li></ul></li><li>方式 <ul><li>根据句子来切分（split by sentences)</li><li>按照字符数，采用固定窗口来切分（fixed window character count）</li><li>按照字符数，采用滑动窗口来切分（moving window character count）</li><li>递归方法：RecursiveCharacterTextSplitter（固定窗口+语义分割；LangChain采用了此；通常采用此）</li><li>根据语义来分割（操作难度比较大；可能有些Chunk太长，有些又太短）</li></ul></li></ul><h2 id="_6-rag优化-——-query优化" tabindex="-1"><a class="header-anchor" href="#_6-rag优化-——-query优化" aria-hidden="true">#</a> 6. RAG优化 —— Query优化</h2><ul><li>Rewrite</li><li>Expand</li></ul><h3 id="_6-1-case1-self-querying-retrieval" tabindex="-1"><a class="header-anchor" href="#_6-1-case1-self-querying-retrieval" aria-hidden="true">#</a> 6.1. Case1：Self-Querying Retrieval</h3><ul><li>将Query进行信息抽取：Self-Querying Retrieval <ul><li>将自然语言形式的Query通过LLM转化为结构化的Query</li><li>将元数据与向量一起存储在向量数据库中 <ul><li>属性：metadata （可以先通过属性进行过滤）</li><li>非属性：embedding内容信息（再进行语义搜索）</li></ul></li></ul></li></ul><figure><img src="/blog/assets/010_self_querying_retrieval-dNhNOhiw.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><blockquote><p>图中只对产品的名称进行了语义嵌入，其他信息都是属性信息metadata</p></blockquote><p>思路：</p><ul><li>1.将Query通过LLM转化为结构化Query,拆出metadata和用于embedding的部分</li><li>2.用metadata在Vector Database中进行过滤</li><li>3.用embedding部分在Vector Database中进行向量搜索</li></ul><p>langchain的Self-Querying Retrieval</p><p>https://python.langchain.com/docs/how_to/self_query/</p><figure><img src="/blog/assets/010_self_querying_retrieval1-OmaB_1Qb.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_6-2-case2-multiqueryretriever" tabindex="-1"><a class="header-anchor" href="#_6-2-case2-multiqueryretriever" aria-hidden="true">#</a> 6.2. Case2: MultiQueryRetriever</h3><p>Query Expansion with multiple related questions</p><p>场景</p><ul><li>多个产品的比较:从各个维度比较下小米、华为、三星折叠手机的功能，汇总为表格</li><li>不完整的问题：从多个角度改写几个子问题，询问LLM后再进行汇总</li></ul><p>思路</p><ul><li>1.将Query通过LLM拆分出多个SubQuery</li><li>2.多个SubQuery并行通过LLM获取各自的Output</li><li>3.使用一个LLM将多个Output进行信息汇集，得到最终结果</li></ul><p>具体实现</p><ul><li>langchain的MultiQueryRetriever <ul><li>https://python.langchain.com/docs/how_to/MultiQueryRetriever/</li></ul></li><li>Llamaindex的SubQuestionQueryEngine</li></ul><figure><img src="/blog/assets/010_multi_query_retrieval-sUx8rpxt.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_6-3-case3-回退式提示词-step-back-prompting" tabindex="-1"><a class="header-anchor" href="#_6-3-case3-回退式提示词-step-back-prompting" aria-hidden="true">#</a> 6.3. Case3: 回退式提示词 Step-Back Prompting</h3><p>思路</p><ul><li>1.将Query通过LLM进行抽象生成一个“后退一步的问题”Stepback Question</li><li>2.采用LLM得到Stepback Question对应的答案Stepback Answer</li><li>3.将原本Query和Stepback Answer结合通过LLM得到结果</li></ul><p>Take a Step Back: Evoking Reasoning via Abstraction in Large Language Models</p><p>https://arxiv.org/abs/2310.06117</p><figure><img src="/blog/assets/010_step_back_prompting-iXxZcrOC.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_6-4-case4-query和history的结合方式" tabindex="-1"><a class="header-anchor" href="#_6-4-case4-query和history的结合方式" aria-hidden="true">#</a> 6.4. Case4: Query和History的结合方式</h3><p>2种结合方式</p><ul><li>Query检索Vector Database后结合History（ContextChatEngine）</li><li>QUery结合History后检索Vector Database（CondensePlusContextMode）</li></ul><figure><img src="/blog/assets/010_query_and_history-Jbm32OHw.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_6-5-case5-假设性答案-hypothetical-answer-hypothetical-document" tabindex="-1"><a class="header-anchor" href="#_6-5-case5-假设性答案-hypothetical-answer-hypothetical-document" aria-hidden="true">#</a> 6.5. Case5: 假设性答案 Hypothetical Answer / Hypothetical Document</h3><p>Embeddings (HyDE) 使用生成的答案扩展查询 Query Expansion with a generated answer</p><p>思路</p><ul><li>1.先通过LLM生成Query的一个答案Answer</li><li>2.将Query和Answer结合去检索Vector Database</li></ul><figure><img src="/blog/assets/010_hypothetical_answer-zQBNUeR9.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>论文：https://boston.lti.cs.cmu.edu/luyug/HyDE/HyDE.pdf</p><p>与Indexing优化的假设性问题是反向的逻辑</p><h3 id="_6-6-case6-查询重写" tabindex="-1"><a class="header-anchor" href="#_6-6-case6-查询重写" aria-hidden="true">#</a> 6.6. Case6: 查询重写</h3><p>使用大语言模型重新构造初始查询以提高检索效果。LangChain和LlamaIndex都有实现，尽管有些不同，但我认为LlamaIndex的解决方案在这里更为强大。</p><h3 id="_6-7-case7-查询路由" tabindex="-1"><a class="header-anchor" href="#_6-7-case7-查询路由" aria-hidden="true">#</a> 6.7. Case7: 查询路由</h3><p>查询路由是一种基于LLM的决策步骤</p><p>查询路由器还用于选择合适的索引或更广泛的数据存储位置来处理用户查询。</p><ul><li>具体实现 <ul><li>llamaindex <ul><li>https://docs.llamaindex.ai/en/stable/module_guides/querying/router/</li></ul></li><li>langchain <ul><li>https://python.langchain.com/docs/how_to/routing/</li></ul></li></ul></li></ul><h2 id="_7-rag优化-——-retriever优化" tabindex="-1"><a class="header-anchor" href="#_7-rag优化-——-retriever优化" aria-hidden="true">#</a> 7. RAG优化 —— Retriever优化</h2><h3 id="_7-1-case1-句子窗口检索-sentence-window-retrieval" tabindex="-1"><a class="header-anchor" href="#_7-1-case1-句子窗口检索-sentence-window-retrieval" aria-hidden="true">#</a> 7.1. Case1：句子窗口检索 Sentence Window Retrieval</h3><p>理念：理念是检索较小的块以提高搜索质量，但同时增加周围的上下文以供LLM进行推理分析。<br> 尽可能获得更多的Context,而细粒度的Chunk更准确<br> 思想：检索出的Chunk邻近的Chunk也与Query相关，于是将该Chunk与邻近Chunk一并返回<br> 缺点：Context Size太大</p><p>思路</p><ul><li>1.将文档中每个句子作为一个Chunk，来提高搜索准确度</li><li>2.将检索出的关键句子前后扩展k个句子后返回</li></ul><figure><img src="/blog/assets/010_sentence_window_retrieval-fARWZ_Fi.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_7-2-case2-父文档检索器-parent-child-chunks-retrieval-from-small-to-big" tabindex="-1"><a class="header-anchor" href="#_7-2-case2-父文档检索器-parent-child-chunks-retrieval-from-small-to-big" aria-hidden="true">#</a> 7.2. Case2: 父文档检索器 Parent-child chunks retrieval /from small to big</h3><p>理念：理念是检索较小的块以提高搜索质量，但同时增加周围的上下文以供LLM进行推理分析。 思想：与句子窗口检索器十分相似——它旨在搜索更精细的信息片段，然后在将这些上下文信息提供给LLM进行推理之前，先扩展上下文窗口</p><p>思路</p><ul><li>1.将文档按粗粒度大小分割为Parent Chunks, 每个Parent Chunks再细分为Child Chunks, 将Child Chunks存入Vector Database</li><li>2.由Query查询Vector Database检索出相关的Child Chunks</li><li>3.返回Child Chunks所在的Parent Chunks(去重的结果)</li></ul><figure><img src="/blog/assets/010_from_small_to_big-jXeq9iYN.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>想要更深入了解这个方法，可以查看LlamaIndex关于递归检索器和节点引用的教程</p><h3 id="_7-3-case3-混合检索-fusion-retrieval" tabindex="-1"><a class="header-anchor" href="#_7-3-case3-混合检索-fusion-retrieval" aria-hidden="true">#</a> 7.3. Case3: 混合检索 Fusion Retrieval</h3><p>结合了关键词搜索和语义搜索，即密集搜索和稀疏搜索的结合。</p><figure><img src="/blog/assets/010_fusion_retrieval-KsNZzVGl.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="_8-rag优化-——-ranking优化" tabindex="-1"><a class="header-anchor" href="#_8-rag优化-——-ranking优化" aria-hidden="true">#</a> 8. RAG优化 —— Ranking优化</h2><ul><li>粗排与精排 <ul><li>粗排：Vector Database的Indexing</li><li>精排：得到Vector Database的结果后进行的排序</li></ul></li></ul><h3 id="_8-1-逆序位融合算法-rrf-reciprocal-rank-fusion" tabindex="-1"><a class="header-anchor" href="#_8-1-逆序位融合算法-rrf-reciprocal-rank-fusion" aria-hidden="true">#</a> 8.1. 逆序位融合算法 RRF (Reciprocal Rank Fusion)</h3><figure><img src="/blog/assets/010_rrf-IW3tIrOp.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>这里的关键是正确结合具有不同相似度评分的检索结果。这个问题通常通过Reciprocal Rank Fusion算法解决，该算法会对检索结果进行重新排名，以产生最终输出。</p><p>在LangChain中，这一功能是通过Ensemble Retriever类实现的，它结合了您定义的一系列检索器，例如faiss向量索引和基于BM25的检索器，并使用逆序位融合算法（RRF）来进行结果的重新排名。在LlamaIndex中，实现这一功能的方式非常类似。</p><h2 id="_9-rag优化-——-indexing优化" tabindex="-1"><a class="header-anchor" href="#_9-rag优化-——-indexing优化" aria-hidden="true">#</a> 9. RAG优化 —— Indexing优化</h2><h3 id="_9-1-层次索引" tabindex="-1"><a class="header-anchor" href="#_9-1-层次索引" aria-hidden="true">#</a> 9.1. 层次索引</h3><p>创建两个索引——一个由摘要组成，另一个由文档块组成，然后分两步进行搜索：首先通过摘要过滤出相关文档，接着只在这个相关群体内进行搜索。</p><figure><img src="/blog/assets/010_hierarchical_index_retrieval-qgQ8lofH.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_9-2-假设性问题" tabindex="-1"><a class="header-anchor" href="#_9-2-假设性问题" aria-hidden="true">#</a> 9.2. 假设性问题</h3><p>让LLM为每个块生成一个假设性问题，并将这些问题以向量形式嵌入，用问题向量替代块向量。</p><p>由于查询和假设性问题之间的语义相似性更高，从而提高了搜索质量。</p><p>与Query优化的假设性答案是反向的逻辑</p><h2 id="_10-rag优化-——-其他优化" tabindex="-1"><a class="header-anchor" href="#_10-rag优化-——-其他优化" aria-hidden="true">#</a> 10. RAG优化 —— 其他优化</h2><h3 id="reference-citations-参考引用" tabindex="-1"><a class="header-anchor" href="#reference-citations-参考引用" aria-hidden="true">#</a> Reference citations 参考引用</h3><p>是否能准确地反向找到答案的来源处</p><h2 id="_11-graphrag" tabindex="-1"><a class="header-anchor" href="#_11-graphrag" aria-hidden="true">#</a> 11. GraphRAG</h2><p>利用知识图谱捕捉实体间复杂关系，特别适用于处理关系丰富的数据</p><p>场景：假设我们正在开发一个智能问答系统，用于回答有关历史人物及其相互关系的问题。</p><p>问题：用户问：“亚历山大大帝的将军是谁，他们共同参与了哪些战役？”</p><p>传统RAG的挑战：</p><ul><li>传统RAG可能在检索阶段找到关于亚历山大大帝及其将军的文档，但这些文档可能只包含部分信息，或者信息分散在不同的文档中。</li><li>它可能难以从检索到的文本中提取并整合所有相关信息，尤其是当这些信息需要跨越多个文档和上下文时。</li></ul><p>GraphRAG的解决方案：</p><ul><li>1.构建知识图谱：GraphRAG首先从历史文献和资料中提取实体（如亚历山大大帝、他的将军们）和关系（如指挥关系、参与战役），构建一个知识图谱。</li><li>2.图查询：用户的查询被转换为图查询，系统在知识图谱中搜索与亚历山大大帝相关的将军节点，以及与这些节点相连的战役节点。</li><li>3.提取子图：系统不仅检索到单独的节点，还检索到节点间的连接关系，形成一个子图，这个子图包含了所有相关的将军和战役信息。</li><li>4.生成回答：GraphRAG利用这个子图作为上下文，指导语言模型生成一个详细的回答，这个回答不仅包括将军的名字，还包括他们共同参与的战役。</li></ul><p>优缺点</p><ul><li>优：能够捕捉和表示实体间的复杂关系，整合和检索分散在不同文档中的信息。</li><li>缺：构建和维护知识图谱的高成本以及对复杂图结构管理的技术挑战，在处理抽象概念时也存在困难。</li></ul><h2 id="_12-hybirdrag" tabindex="-1"><a class="header-anchor" href="#_12-hybirdrag" aria-hidden="true">#</a> 12. HybirdRAG</h2><p>Paper Name: HybridRAG: Integrating Knowledge Graphs and Vector Retrieval Augmented Generation for Efficient Information Extraction</p><p>Paper: https://arxiv.org/pdf/2408.04948v1</p><ul><li>1.信息检索：从外部文档中检索与查询相关的信息，使用向量数据库进行广泛、基于相似性的检索（VectorRAG部分），同时从知识图谱中检索结构化、关系丰富的上下文数据（GraphRAG部分）。</li><li>2.上下文整合：将VectorRAG提供的广泛信息检索结果与GraphRAG提供的精确关系数据相结合，形成统一的上下文。</li><li>3.生成回答：利用大型语言模型（LLM）根据整合后的上下文生成最终的回答。</li></ul><h2 id="_13-references" tabindex="-1"><a class="header-anchor" href="#_13-references" aria-hidden="true">#</a> 13. References</h2><ul><li><a href="https://pub.towardsai.net/advanced-rag-techniques-an-illustrated-overview-04d193d8fec6" target="_blank" rel="noopener noreferrer">Advanced RAG Techniques: an Illustrated Overview<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></div><!--[--><!----><!--]--><footer class="page-meta"><!----><div class="meta-item git-info"><!----><!----></div></footer><nav class="vp-page-nav"><a aria-label="向量数据库与相似性搜索" class="vp-link nav-link prev nav-link prev" href="/blog/zh/posts/llm/011_vector_database.html"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><span class="font-icon icon fa-fw fa-sm fas fa-lightbulb" style=""></span>向量数据库与相似性搜索</div></a><a aria-label="大模型的商业化落地挑战" class="vp-link nav-link next nav-link next" href="/blog/zh/posts/llm/009_llm_challenge.html"><div class="hint">下一页<span class="arrow end"></span></div><div class="link">大模型的商业化落地挑战<span class="font-icon icon fa-fw fa-sm fas fa-lightbulb" style=""></span></div></a></nav><!----><!--[--><!----><!--]--><!--]--></main><!--]--><!----></div><!--]--><!--]--><!----><!--]--></div>
    <script type="module" src="/blog/assets/app-kXW_Y_m4.js" defer></script>
  </body>
</html>
